# Guardrails

> **Purpose**: Document lessons learned from errors. Read FIRST every iteration.
> **Philosophy**: Each Sign makes Ralph smarter without consuming context.

---

## How Signs Work

When an error occurs:
1. Ralph encounters a problem
2. Adds a Sign to this file
3. **Next iteration reads Signs FIRST**
4. Follows instructions to avoid repeating the error

**This creates compounding intelligence across iterations.**

---

## Signs (Lessons Learned)

<!-- ──────────────────────────────────────────────────────────── -->
<!-- Template for adding new Signs:                              -->
<!--                                                              -->
<!-- ### Sign: [Brief description of problem]                    -->
<!-- - **Trigger**: [Exact condition that causes this]           -->
<!-- - **Instruction**: [Specific action to prevent]             -->
<!-- - **Added after**: [Iteration N]                            -->
<!-- ──────────────────────────────────────────────────────────── -->

### Sign: Example - Circular dependency
- **Trigger**: When module A imports B which imports A
- **Instruction**: Create shared interface in src/lib/types.ts first, then implement in both modules
- **Added after**: Iteration 7

### Sign: Example - Race condition in tests
- **Trigger**: Test passes/fails inconsistently with timing-dependent code
- **Instruction**: Use condition-based waiting (waitFor, waitUntil), never setTimeout/sleep
- **Added after**: Iteration 12

### Sign: Example - Missing database migration
- **Trigger**: Code references new column but migration doesn't exist
- **Instruction**: Always create migration file BEFORE using new DB fields in code
- **Added after**: Iteration 3

---

<!-- ──────────────────────────────────────────────────────────── -->
<!-- INSTRUCTIONS FOR RALPH                                       -->
<!-- ──────────────────────────────────────────────────────────── -->

## Guidelines for Adding Signs

**Add a Sign when:**
- Error occurred that could happen again
- Pattern would help future iterations
- Gotcha discovered about framework/tools
- Integration sequence matters
- Test pattern prevents flakiness

**Don't add Sign for:**
- One-off typos
- Environment-specific issues
- Unclear requirements (spec problem, not code problem)
- Personal preferences (those go in AGENTS.md)

**Format:**
- **Trigger**: Be specific about WHEN this applies
- **Instruction**: Be specific about WHAT to do instead
- **Added after**: Include iteration number for context

---

<!-- ──────────────────────────────────────────────────────────── -->
<!-- NEVER DELETE SIGNS                                           -->
<!-- ──────────────────────────────────────────────────────────── -->

## Maintenance Notes

**Never delete Signs** - They compound intelligence
**Do consolidate** - If 3+ Signs about same topic, merge into one comprehensive Sign
**Do prioritize** - Move critical Signs to top for visibility

---

_Signs are added during execution by Ralph._
_Every iteration reads this file FIRST before doing anything else._
_This is how Ralph learns and improves across iterations._
