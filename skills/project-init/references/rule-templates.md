# Rule File Templates

Each file targets ~25-40 lines. Total budget: <2000 tokens across all 4 files.

**Subtraction test**: Before including any field, ask: "Without this, would Claude make a wrong decision?" If no → omit.

## Field Ownership

Concepts that could appear in multiple files have ONE canonical home. Never duplicate.

| Concept | Canonical File | NOT in |
|---|---|---|
| Test command (`npm test`, `pytest`) | conventions.md → Testing | stack.md Scripts |
| Test framework name + config | conventions.md → Testing | stack.md |
| Versioning format (CalVer, SemVer) | conventions.md → Versioning | stack.md Scripts |
| Version bump command | stack.md → Scripts | conventions.md |
| Import rules (ESM/CJS, paths) | conventions.md → Imports | architecture.md |
| Design philosophy (FP, OOP, DDD) | project.md → Paradigms | architecture.md Boundaries |
| Layer import restrictions | architecture.md → Boundaries | project.md Paradigms |
| CI/CD pipeline names + stages | stack.md → CI/CD | conventions.md |
| Commit message format | conventions.md → Code Style | stack.md |

**Rule**: If the same fact appears in two files, keep it in the file whose ONE QUESTION it answers.

## project.md (~25 lines)

```markdown
# Project

## Purpose
[1-2 sentences extracted from manifest description or README first paragraph]

## Paradigms
[Design philosophies detected from code patterns — only include those with clear evidence]
[WHAT philosophy, not WHERE enforced — enforcement rules go in architecture.md Boundaries]
- [paradigm]: [how it manifests — e.g., "event-driven: domain events decouple bounded contexts"]

## Domain
[CONDITIONAL — omit if no clear domain concepts detected]
[Key business entities found in types, directory names, and variable names]
- [concept]: [one-line definition inferred from usage context]

---
*Auto-generated by /project-init on [DATE]*
```

## architecture.md (~35 lines)

```markdown
# Architecture

## Entry Point
`[path]` → [what it bootstraps]

## Layers
\```
[dir1]/     # [purpose — what belongs here]
[dir2]/     # [purpose]
[dir3]/     # [purpose]
[dir4]/     # [purpose]
\```

## Boundaries
[WHO can import WHOM — structural rules, not design philosophies]
[e.g., "Controllers import Services, never the reverse"]
[Philosophy names go in project.md Paradigms]

## Data Flow
[Request path from entry to response, if applicable]
[e.g.: "Request → middleware → controller → service → repository → DB"]

## API Type
[REST | GraphQL | gRPC | WebSocket | CLI | Library | None]

---
*Auto-generated by /project-init on [DATE]*
```

## stack.md (~30 lines)

```markdown
# Stack

**Runtime**: [runtime + version]
**Framework**: [main framework + version]
**Type**: [monorepo | library | CLI | API | SaaS | static-site]

## Critical Dependencies
- [dep1] ([version]) — [one-word purpose]
- [dep2] ([version]) — [purpose]
- [dep3] ([version]) — [purpose]
- [dep4] ([version]) — [purpose]
- [dep5] ([version]) — [purpose]

## Scripts
[Build, dev, lint, version commands. Test commands live in conventions.md Testing]
- `[cmd1]` — [what it does]
- `[cmd2]` — [what it does]
- `[cmd3]` — [what it does]

## Environment
[Only if .env.example exists]
- `[VAR1]` — [purpose]
- `[VAR2]` — [purpose]

---
*Auto-generated by /project-init on [DATE]*
```

## conventions.md (~40 lines)

```markdown
# Conventions

## Naming
- Files: [convention] (`example`)
- Functions: [convention] (`example`)
- Types/Classes: [convention] (`example`)
- Constants: [convention] (`example`)

## Error Handling
- Pattern: [dominant pattern]
- Philosophy: [throw/return/Result — and why]

## Imports
- Style: [ESM | CJS | mixed]
- Order: [standard lib → third-party → internal]
- Paths: [relative | absolute | aliases]

## Code Style
[Only if explicitly configured — omit if using defaults]
- [key rule 1]
- [key rule 2]

## Testing
[CONDITIONAL — omit entire section if no tests detected]
- Framework: [name]
- Location: [pattern, e.g., `__tests__/` or colocated `*.test.*`]
- Run: `[command]`
- Coverage: `[command]` (if configured)

## Versioning
[CONDITIONAL — omit if no versioning scheme detected]
- Format: [CalVer YYYY.MINOR.MICRO | SemVer MAJOR.MINOR.PATCH]
- Synced files: [list of files where version appears]
- Changelog: [format if exists]

## Security
[CONDITIONAL — omit if nothing detected]
- Auth: [mechanism]
- Validation: [approach]

---
*Auto-generated by /project-init on [DATE]*
```

## Field Altitude Guide

| Too Low (brittle) | Right Altitude | Too High (vague) |
|---|---|---|
| "Use tabs, 2 spaces" | "Tabs for indentation (configured in .editorconfig)" | "Follow consistent formatting" |
| "Import React from 'react'" | "ESM imports, aliased paths via tsconfig" | "Use standard imports" |
| "Run `npx jest --coverage`" | "`npm test` — Jest with coverage" | "Run the test suite" |
| "layered arch with DI in controllers" | "project: DDD / architecture: Controllers→Services only" | "Follow good architecture" |

---

*Version: 1.1.0 | Updated: 2026-02-16*
